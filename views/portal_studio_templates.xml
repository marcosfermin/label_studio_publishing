<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Studio Bookings Dashboard -->
    <template id="portal_studio_bookings" name="Studio Bookings">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Studio Bookings</t>
            </t>

            <div class="row mt-3">
                <!-- Summary Cards -->
                <div class="col-12">
                    <div class="row">
                        <div class="col-lg-3 col-6 mb-3">
                            <div class="card bg-primary text-white h-100">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <i class="fa fa-calendar fa-2x opacity-75"></i>
                                        <div class="ms-3">
                                            <div class="h4 mb-0" t-esc="booking_stats['total_bookings']"/>
                                            <small class="opacity-75">Total Bookings</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-3 col-6 mb-3">
                            <div class="card bg-success text-white h-100">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <i class="fa fa-clock fa-2x opacity-75"></i>
                                        <div class="ms-3">
                                            <div class="h4 mb-0" t-esc="booking_stats['upcoming_bookings']"/>
                                            <small class="opacity-75">Upcoming</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-3 col-6 mb-3">
                            <div class="card bg-info text-white h-100">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <i class="fa fa-hourglass-half fa-2x opacity-75"></i>
                                        <div class="ms-3">
                                            <div class="h4 mb-0" t-esc="booking_stats['total_hours_booked']"/>
                                            <small class="opacity-75">Hours Booked</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-3 col-6 mb-3">
                            <div class="card bg-warning text-white h-100">
                                <div class="card-body">
                                    <div class="d-flex align-items-center">
                                        <i class="fa fa-dollar-sign fa-2x opacity-75"></i>
                                        <div class="ms-3">
                                            <div class="h4 mb-0" t-field="booking_stats['total_spent']" 
                                                 t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                            <small class="opacity-75">Total Spent</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="col-12 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Quick Actions</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <a href="/my/studio/request" class="btn btn-primary btn-lg w-100">
                                        <i class="fa fa-plus"></i> Request New Booking
                                    </a>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <button type="button" class="btn btn-outline-info btn-lg w-100" 
                                            data-bs-toggle="modal" data-bs-target="#availabilityModal">
                                        <i class="fa fa-search"></i> Check Availability
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bookings List -->
                <div class="col-12">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">My Bookings</h5>
                            <div class="d-flex">
                                <!-- Date Range Filter -->
                                <form method="get" class="d-flex me-3">
                                    <input type="hidden" name="sortby" t-att-value="sortby"/>
                                    <div class="input-group input-group-sm">
                                        <input type="date" name="date_begin" class="form-control" 
                                               t-att-value="date_begin"/>
                                        <input type="date" name="date_end" class="form-control" 
                                               t-att-value="date_end"/>
                                        <button type="submit" class="btn btn-outline-secondary">Filter</button>
                                    </div>
                                </form>
                                
                                <!-- Sort Dropdown -->
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" 
                                            type="button" data-bs-toggle="dropdown">
                                        Sort: <t t-esc="searchbar_sortings[sortby]['label']"/>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li t-foreach="searchbar_sortings" t-as="option">
                                            <a class="dropdown-item" 
                                               t-att-href="'%s?sortby=%s&amp;date_begin=%s&amp;date_end=%s' % (default_url, option, date_begin, date_end)"
                                               t-esc="searchbar_sortings[option]['label']"/>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <t t-if="not bookings">
                            <div class="card-body text-center text-muted py-5">
                                <i class="fa fa-calendar fa-3x mb-3"></i>
                                <h5>No Bookings Found</h5>
                                <p>No bookings found for the selected period.</p>
                                <a href="/my/studio/request" class="btn btn-primary">
                                    Make Your First Booking
                                </a>
                            </div>
                        </t>
                        
                        <t t-if="bookings">
                            <div class="table-responsive">
                                <table class="table table-sm mb-0">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Date &amp; Time</th>
                                            <th>Room</th>
                                            <th>Project</th>
                                            <th>Duration</th>
                                            <th>Status</th>
                                            <th>Amount</th>
                                            <th class="text-end">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr t-foreach="bookings" t-as="booking">
                                            <td>
                                                <div class="fw-bold" t-esc="booking.start_date.strftime('%b %d, %Y')"/>
                                                <small class="text-muted">
                                                    <span t-esc="'{:02.0f}:{:02.0f}'.format(*divmod(booking.start_time * 60, 60))"/>
                                                    - <span t-esc="'{:02.0f}:{:02.0f}'.format(*divmod(booking.end_time * 60, 60))"/>
                                                </small>
                                            </td>
                                            <td>
                                                <span t-esc="booking.room_id.name"/>
                                                <t t-if="booking.engineer_id">
                                                    <br/><small class="text-muted">w/ <span t-esc="booking.engineer_id.name"/></small>
                                                </t>
                                            </td>
                                            <td>
                                                <span t-esc="booking.project_name or 'Untitled Project'"/>
                                            </td>
                                            <td>
                                                <span t-esc="booking.duration"/> hours
                                            </td>
                                            <td>
                                                <span class="badge" 
                                                      t-attf-class="badge-#{booking.state == 'confirmed' and 'success' or booking.state == 'draft' and 'warning' or booking.state == 'completed' and 'info' or 'secondary'}">
                                                    <t t-esc="dict(booking._fields['state'].selection)[booking.state]"/>
                                                </span>
                                            </td>
                                            <td>
                                                <span t-field="booking.total_amount" 
                                                      t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                            </td>
                                            <td class="text-end">
                                                <a t-attf-href="/my/studio/#{booking.id}" 
                                                   class="btn btn-sm btn-outline-primary">
                                                    Details
                                                </a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Pagination -->
                            <div class="card-footer" t-if="pager['page_count'] > 1">
                                <t t-call="portal.pager"/>
                            </div>
                        </t>
                    </div>
                </div>
            </div>

            <!-- Availability Check Modal -->
            <div class="modal fade" id="availabilityModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Check Room Availability</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <form id="availabilityForm">
                                <div class="row mb-3">
                                    <div class="col-6">
                                        <label class="form-label">Room</label>
                                        <select name="room_id" class="form-select" required="1">
                                            <option value="">Select Room</option>
                                            <option t-foreach="available_rooms" t-as="room" t-att-value="room.id" t-esc="room.name"/>
                                        </select>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Date</label>
                                        <input type="date" name="check_date" class="form-control" required="1"/>
                                    </div>
                                </div>
                                <div id="availability-results" class="mt-3"></div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" onclick="checkAvailability()">Check Availability</button>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                function checkAvailability() {
                    // Availability check functionality would be implemented here
                    // For now, showing a placeholder message
                    document.getElementById('availability-results').innerHTML = 
                        '<div class="alert alert-info">Availability check feature will be implemented with AJAX.</div>';
                }
            </script>

        </t>
    </template>

    <!-- Studio Booking Detail -->
    <template id="portal_studio_booking_detail" name="Studio Booking Detail">
        <t t-call="portal.portal_layout">
            <div class="row">
                <div class="col-12">
                    <!-- Booking Header -->
                    <div class="card mb-4">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <div>
                                <h4 class="mb-1" t-esc="booking.project_name or 'Studio Booking'"/>
                                <p class="mb-0 text-muted">
                                    <span t-esc="booking.start_date.strftime('%A, %B %d, %Y')"/>
                                    from <span t-esc="'{:02.0f}:{:02.0f}'.format(*divmod(booking.start_time * 60, 60))"/>
                                    to <span t-esc="'{:02.0f}:{:02.0f}'.format(*divmod(booking.end_time * 60, 60))"/>
                                </p>
                            </div>
                            <div class="text-end">
                                <div class="h4 mb-1" t-field="booking.total_amount" 
                                     t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                <span class="badge" 
                                      t-attf-class="badge-#{booking.state == 'confirmed' and 'success' or booking.state == 'draft' and 'warning' or booking.state == 'completed' and 'info' or 'secondary'}">
                                    <t t-esc="dict(booking._fields['state'].selection)[booking.state]"/>
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Booking Details -->
                        <div class="col-lg-8">
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5 class="mb-0">Booking Details</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label text-muted">Room</label>
                                            <div class="fw-bold" t-esc="booking.room_id.name"/>
                                            <small class="text-muted" t-esc="booking.room_id.description"/>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label text-muted">Engineer</label>
                                            <div class="fw-bold" t-esc="booking.engineer_id.name if booking.engineer_id else 'Not assigned'"/>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label text-muted">Duration</label>
                                            <div class="fw-bold" t-esc="booking.duration"/> hours
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label text-muted">Hourly Rate</label>
                                            <div class="fw-bold" t-field="booking.room_rate" 
                                                 t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                        </div>
                                    </div>
                                    
                                    <t t-if="booking.notes">
                                        <hr/>
                                        <label class="form-label text-muted">Notes</label>
                                        <div t-esc="booking.notes"/>
                                    </t>
                                </div>
                            </div>

                            <!-- Equipment -->
                            <div class="card mb-4" t-if="booking.equipment_ids">
                                <div class="card-header">
                                    <h5 class="mb-0">Equipment</h5>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-sm mb-0">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Equipment</th>
                                                <th>Category</th>
                                                <th>Daily Rate</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr t-foreach="booking.equipment_ids" t-as="equipment">
                                                <td t-esc="equipment.name"/>
                                                <td t-esc="equipment.category"/>
                                                <td t-field="equipment.daily_rate" 
                                                    t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Sessions -->
                            <div class="card" t-if="sessions">
                                <div class="card-header">
                                    <h5 class="mb-0">Recording Sessions</h5>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-sm mb-0">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Date</th>
                                                <th>Duration</th>
                                                <th>Status</th>
                                                <th>Notes</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr t-foreach="sessions" t-as="session">
                                                <td t-esc="session.session_date.strftime('%b %d, %Y') if session.session_date else ''"/>
                                                <td t-esc="session.actual_duration or session.planned_duration"/> hours</td>
                                                <td>
                                                    <span class="badge" 
                                                          t-attf-class="badge-#{session.state == 'completed' and 'success' or session.state == 'in_progress' and 'warning' or 'secondary'}">
                                                        <t t-esc="dict(session._fields['state'].selection)[session.state]"/>
                                                    </span>
                                                </td>
                                                <td t-esc="session.notes"/>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Cost Breakdown -->
                        <div class="col-lg-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Cost Breakdown</h5>
                                </div>
                                <div class="card-body">
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Room Fee:</span>
                                        <span t-field="booking.room_cost" 
                                              t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2" t-if="booking.equipment_cost">
                                        <span>Equipment:</span>
                                        <span t-field="booking.equipment_cost" 
                                              t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2" t-if="booking.engineer_fee">
                                        <span>Engineer Fee:</span>
                                        <span t-field="booking.engineer_fee" 
                                              t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                    </div>
                                    <hr/>
                                    <div class="d-flex justify-content-between fw-bold">
                                        <span>Total:</span>
                                        <span t-field="booking.total_amount" 
                                              t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                    </div>
                                    
                                    <t t-if="booking.deposit_amount">
                                        <hr/>
                                        <div class="d-flex justify-content-between">
                                            <span>Deposit:</span>
                                            <span t-field="booking.deposit_amount" 
                                                  t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                        </div>
                                        <div class="d-flex justify-content-between">
                                            <span>Balance Due:</span>
                                            <span t-esc="booking.total_amount - booking.deposit_amount" 
                                                  t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                        </div>
                                    </t>
                                </div>
                            </div>

                            <!-- Contact Information -->
                            <div class="card mt-4">
                                <div class="card-header">
                                    <h6 class="mb-0">Need Help?</h6>
                                </div>
                                <div class="card-body">
                                    <p class="small mb-2">Contact our studio team:</p>
                                    <p class="small mb-1">
                                        <i class="fa fa-phone text-muted me-2"></i>
                                        <a href="tel:+1234567890">+1 (234) 567-8900</a>
                                    </p>
                                    <p class="small mb-1">
                                        <i class="fa fa-envelope text-muted me-2"></i>
                                        <a href="mailto:studio@company.com">studio@company.com</a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Studio Booking Request Form -->
    <template id="portal_studio_booking_request" name="Studio Booking Request">
        <t t-call="portal.portal_layout">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header">
                            <h4 class="mb-0">Request Studio Booking</h4>
                            <p class="mb-0 text-muted">Fill out the form below to request a studio booking.</p>
                        </div>
                        
                        <form method="post">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            
                            <div class="card-body">
                                <t t-if="error_message">
                                    <div class="alert alert-danger" role="alert">
                                        <i class="fa fa-exclamation-triangle me-2"></i>
                                        <span t-esc="error_message"/>
                                    </div>
                                </t>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label required">Room</label>
                                        <select name="room_id" class="form-select" required="1">
                                            <option value="">Select a room</option>
                                            <option t-foreach="rooms" t-as="room" t-att-value="room.id">
                                                <span t-esc="room.name"/> - <span t-field="room.hourly_rate" t-options="{'widget': 'monetary'}"/>/hour
                                            </option>
                                        </select>
                                        <small class="form-text text-muted">Choose the studio room for your session.</small>
                                    </div>
                                    
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Engineer</label>
                                        <select name="engineer_id" class="form-select">
                                            <option value="">No engineer required</option>
                                            <option t-foreach="engineers" t-as="engineer" t-att-value="engineer.id" t-esc="engineer.name"/>
                                        </select>
                                        <small class="form-text text-muted">Optional: Request a specific engineer.</small>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">Start Date</label>
                                        <input type="date" name="start_date" class="form-control" required="1"/>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">Start Time</label>
                                        <input type="time" name="start_time" class="form-control" required="1"/>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">End Time</label>
                                        <input type="time" name="end_time" class="form-control" required="1"/>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Project Name</label>
                                    <input type="text" name="project_name" class="form-control" 
                                           placeholder="e.g., Album Recording, Demo Session"/>
                                    <small class="form-text text-muted">Help us identify your project.</small>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Additional Notes</label>
                                    <textarea name="notes" class="form-control" rows="3" 
                                              placeholder="Special requirements, equipment needs, etc."></textarea>
                                </div>
                            </div>

                            <div class="card-footer">
                                <div class="d-flex justify-content-between">
                                    <a href="/my/studio" class="btn btn-secondary">Cancel</a>
                                    <button type="submit" class="btn btn-primary">Submit Request</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Catalog View -->
    <template id="portal_catalog" name="My Catalog">
        <t t-call="portal.portal_layout">
            <div class="row">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2>My Catalog</h2>
                        <div class="text-muted">
                            <small>Updated daily with latest performance data</small>
                        </div>
                    </div>

                    <!-- Summary Cards -->
                    <div class="row mb-4">
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fa fa-music fa-2x text-primary mb-2"></i>
                                    <div class="h4 mb-0" t-esc="catalog_stats['recordings_count']"/>
                                    <small class="text-muted">Recordings</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fa fa-file-alt fa-2x text-info mb-2"></i>
                                    <div class="h4 mb-0" t-esc="catalog_stats['works_count']"/>
                                    <small class="text-muted">Works</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fa fa-compact-disc fa-2x text-success mb-2"></i>
                                    <div class="h4 mb-0" t-esc="catalog_stats['releases_count']"/>
                                    <small class="text-muted">Releases</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fa fa-play fa-2x text-warning mb-2"></i>
                                    <div class="h4 mb-0" t-esc="'{:,.0f}'.format(catalog_stats['ytd_streams'])"/>
                                    <small class="text-muted">YTD Streams</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fa fa-dollar-sign fa-2x text-danger mb-2"></i>
                                    <div class="h6 mb-0" t-field="catalog_stats['ytd_earnings']" 
                                         t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                    <small class="text-muted">YTD Earnings</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-6 mb-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fa fa-globe fa-2x text-secondary mb-2"></i>
                                    <div class="h4 mb-0" t-esc="catalog_stats['territories_count']"/>
                                    <small class="text-muted">Territories</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabs -->
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#recordings">Recordings</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#works">Works</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#releases">Releases</a>
                        </li>
                    </ul>

                    <div class="tab-content">
                        <!-- Recordings Tab -->
                        <div class="tab-pane fade show active" id="recordings">
                            <div class="card border-top-0">
                                <div class="card-header border-top-0">
                                    <h5 class="mb-0">My Recordings</h5>
                                </div>
                                <t t-if="not recordings">
                                    <div class="card-body text-center text-muted py-5">
                                        <i class="fa fa-music fa-3x mb-3"></i>
                                        <h5>No Recordings</h5>
                                        <p>You don't have any recordings in the system yet.</p>
                                    </div>
                                </t>
                                <t t-if="recordings">
                                    <div class="table-responsive">
                                        <table class="table table-sm mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>Title</th>
                                                    <th>Artists</th>
                                                    <th>ISRC</th>
                                                    <th>Duration</th>
                                                    <th>Release Date</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr t-foreach="recordings" t-as="recording">
                                                    <td>
                                                        <div class="fw-bold" t-esc="recording.title"/>
                                                        <small class="text-muted" t-esc="recording.version" t-if="recording.version"/>
                                                    </td>
                                                    <td>
                                                        <span t-esc="', '.join(recording.main_artist_ids.mapped('name'))"/>
                                                    </td>
                                                    <td><small t-esc="recording.isrc"/></td>
                                                    <td><small t-esc="recording.duration"/></td>
                                                    <td><small t-esc="recording.recording_date.strftime('%b %Y') if recording.recording_date else ''"/></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </t>
                            </div>
                        </div>

                        <!-- Works Tab -->
                        <div class="tab-pane fade" id="works">
                            <div class="card border-top-0">
                                <div class="card-header border-top-0">
                                    <h5 class="mb-0">My Works</h5>
                                </div>
                                <t t-if="not works">
                                    <div class="card-body text-center text-muted py-5">
                                        <i class="fa fa-file-alt fa-3x mb-3"></i>
                                        <h5>No Works</h5>
                                        <p>You don't have any works in the system yet.</p>
                                    </div>
                                </t>
                                <t t-if="works">
                                    <div class="table-responsive">
                                        <table class="table table-sm mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>Title</th>
                                                    <th>Writers</th>
                                                    <th>ISWC</th>
                                                    <th>PRO</th>
                                                    <th>Registration Date</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr t-foreach="works" t-as="work">
                                                    <td>
                                                        <div class="fw-bold" t-esc="work.title"/>
                                                        <small class="text-muted" t-esc="work.subtitle" t-if="work.subtitle"/>
                                                    </td>
                                                    <td>
                                                        <span t-esc="', '.join(work.writer_ids.mapped('name'))"/>
                                                    </td>
                                                    <td><small t-esc="work.iswc"/></td>
                                                    <td><small t-esc="work.pro_id.name if work.pro_id else ''"/></td>
                                                    <td><small t-esc="work.registration_date.strftime('%b %Y') if work.registration_date else ''"/></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </t>
                            </div>
                        </div>

                        <!-- Releases Tab -->
                        <div class="tab-pane fade" id="releases">
                            <div class="card border-top-0">
                                <div class="card-header border-top-0">
                                    <h5 class="mb-0">My Releases</h5>
                                </div>
                                <t t-if="not releases">
                                    <div class="card-body text-center text-muted py-5">
                                        <i class="fa fa-compact-disc fa-3x mb-3"></i>
                                        <h5>No Releases</h5>
                                        <p>You don't have any releases in the system yet.</p>
                                    </div>
                                </t>
                                <t t-if="releases">
                                    <div class="table-responsive">
                                        <table class="table table-sm mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>Title</th>
                                                    <th>Artist</th>
                                                    <th>Type</th>
                                                    <th>UPC</th>
                                                    <th>Release Date</th>
                                                    <th>Tracks</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr t-foreach="releases" t-as="release">
                                                    <td>
                                                        <div class="fw-bold" t-esc="release.title"/>
                                                        <small class="text-muted" t-esc="release.label_id.name if release.label_id else ''"/>
                                                    </td>
                                                    <td>
                                                        <span t-esc="', '.join(release.main_artist_ids.mapped('name'))"/>
                                                    </td>
                                                    <td><small t-esc="release.release_type"/></td>
                                                    <td><small t-esc="release.upc"/></td>
                                                    <td><small t-esc="release.release_date.strftime('%b %d, %Y') if release.release_date else ''"/></td>
                                                    <td><small t-esc="len(release.recording_ids)"/></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Approvals Dashboard -->
    <template id="portal_approvals" name="Pending Approvals">
        <t t-call="portal.portal_layout">
            <div class="row">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2>Pending Approvals</h2>
                        <span class="badge badge-warning badge-pill" t-esc="len(pending_items)"/>
                    </div>

                    <t t-if="not pending_items">
                        <div class="card">
                            <div class="card-body text-center text-muted py-5">
                                <i class="fa fa-check-circle fa-3x mb-3 text-success"></i>
                                <h5>All Caught Up!</h5>
                                <p>You have no pending items requiring approval.</p>
                                <a href="/my/royalties" class="btn btn-primary">View Royalties</a>
                            </div>
                        </div>
                    </t>

                    <t t-if="pending_items">
                        <div class="row">
                            <div t-foreach="pending_items" t-as="item" class="col-lg-6 mb-4">
                                <div class="card h-100">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <span class="badge" 
                                              t-attf-class="badge-#{item['type'] == 'royalty_statement' and 'warning' or 'info'}">
                                            <t t-if="item['type'] == 'royalty_statement'">Statement</t>
                                            <t t-if="item['type'] == 'split_sheet'">Split Sheet</t>
                                        </span>
                                        <small class="text-muted" t-esc="item['date'].strftime('%b %d, %Y')"/>
                                    </div>
                                    <div class="card-body">
                                        <h6 class="card-title" t-esc="item['title']"/>
                                        
                                        <div class="row">
                                            <div class="col-6" t-if="item.get('amount')">
                                                <small class="text-muted">Amount</small>
                                                <div t-field="item['amount']" 
                                                     t-options="{'widget': 'monetary', 'display_currency': user.company_id.currency_id}"/>
                                            </div>
                                            <div class="col-6" t-if="item.get('percentage')">
                                                <small class="text-muted">Your Share</small>
                                                <div t-esc="item['percentage']"/>%
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-footer">
                                        <a t-att-href="item['url']" class="btn btn-primary btn-sm">
                                            Review &amp; Approve
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </div>
            </div>
        </t>
    </template>

</odoo>